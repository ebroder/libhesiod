# Makefile for the Project Athena Hesiod Nameserver library
#
#	$Source: /afs/dev.mit.edu/source/repository/athena/lib/hesiod/Imakefile,v $
#	$Author: probe $
#	$Header: /afs/dev.mit.edu/source/repository/athena/lib/hesiod/Imakefile,v 1.6 1991-01-22 13:22:03 probe Exp $

#if defined(_AIX) && defined(_IBMR2)
MACHDEF= -DBIT_ZERO_ON_LEFT
#endif

DEFINES=-I. -DHESIOD $(MACHDEF)

SRCS = hesiod.c hespwnam.c hesmailhost.c hesservbyname.c resolve.c cistrcmp.c 
OBJS = hesiod.o hespwnam.o hesmailhost.o hesservbyname.o resolve.o cistrcmp.o 


#ifdef ULTRIX31
.c.o:
	-$(CC) -c -pg ${CFLAGS} $*.c
	-mv $*.o profiled/$*.o
	$(CC) -c ${CFLAGS} $*.c

libhesiod.a:	${OBJS}
	@echo Building Hesiod library...
	rm -rf tmp
	mkdir tmp
	(cd tmp; ar x /usr/local/lib/libresolv.a)
	ar rc $@ ${OBJS} tmp//**/*.o
	ranlib $@
	rm -rf tmp
	mkdir tmp
	(cd tmp; ar x /usr/local/lib/libresolv_p.a)
	cd profiled; ar rc ../libhesiod_p.a ${OBJS} ../tmp//**/*.o
	ranlib libhesiod_p.a

#else

ProfiledObjectRule()

SimpleLibrary(hesiod,$(OBJS),$(ATHLIBDIR))

#endif

SimpleLint(hesiod,$(SRCS))

SimpleProgram(hesinfo,hesinfo.o libhesiod.a,,/bin/athena/)

install_man(hesiod.3,hesiod.3)
install_man(hesinfo.1,hesinfo.1)

install_file(hesiod.h,$(ATHINCDIR)/hesiod.h)
